global
       log 127.0.0.1 local0
       chroot /var/lib/haproxy
       maxconn 4096
       user haproxy
       group haproxy
       daemon
       tune.ssl.default-dh-param 2048
       stats socket /run/haproxy/admin.sock mode 660 level admin

stats enable
       stats socket /var/run/haproxy.sock mode 600 level admin
       stats timeout 2m

defaults
       log     global
       mode    http
       option  httplog
       option  dontlognull
       option  redispatch
       option  forwardfor
       option  http-server-close
       maxconn 4000
       timeout connect 5000
       timeout client 50000
       timeout server 50000
       errorfile 400 /usr/local/etc/haproxy/errors/400.http
       errorfile 403 /usr/local/etc/haproxy/errors/403.http
       errorfile 408 /usr/local/etc/haproxy/errors/408.http
       errorfile 500 /usr/local/etc/haproxy/errors/500.http
       errorfile 502 /usr/local/etc/haproxy/errors/502.http
       errorfile 503 /usr/local/etc/haproxy/errors/503.http
       errorfile 504 /usr/local/etc/haproxy/errors/504.http

frontend normal
        bind *:80
        bind *:443 ssl crt /etc/ssl/certs/server.bundle.pem
        mode http
        option forwardfor
#        reqirep ^([^ :]*)/v2(.*$)1 /artifactory/api/docker/docker-local
	reqadd X-Forwarded-Proto:\ https
#        reqadd X-Forwarded-Proto: https if { ssl_fc }
        option forwardfor header X-Real-IP
        default_backend normal

backend normal
        mode http
        server artifactory artifcatoy.domain.com:8081
